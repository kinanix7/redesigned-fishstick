<div class="profile-edit-container">
  <div class="page-header">
    <h1>Edit Profile</h1>
    <button mat-stroked-button (click)="goBack()">
      <mat-icon>arrow_back</mat-icon>
      Back to Profile
    </button>
  </div>

  <mat-card class="profile-edit-card">
    <mat-card-header>
      <div class="header-content">
        <div class="profile-avatar">
          <mat-icon class="avatar-icon">account_circle</mat-icon>
        </div>
        <div class="header-text">
          <mat-card-title>Update Your Information</mat-card-title>
          <mat-card-subtitle
            >Keep your profile information up to date</mat-card-subtitle
          >
        </div>
      </div>
    </mat-card-header>

    <mat-card-content>
      <form
        [formGroup]="profileForm"
        (ngSubmit)="onSubmit()"
        class="profile-form"
      >
        <!-- Personal Information Section -->
        <div class="form-section">
          <h3 class="section-title">
            <mat-icon>person</mat-icon>
            Personal Information
          </h3>

          <div class="form-row">
            <mat-form-field appearance="outline" class="half-width">
              <mat-label>First Name</mat-label>
              <input matInput formControlName="firstName" required />
              <mat-icon matSuffix>badge</mat-icon>
              <mat-error
                *ngIf="profileForm.get('firstName')?.hasError('required')"
              >
                First name is required
              </mat-error>
              <mat-error
                *ngIf="profileForm.get('firstName')?.hasError('minlength')"
              >
                First name must be at least 2 characters
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
              <mat-label>Last Name</mat-label>
              <input matInput formControlName="lastName" required />
              <mat-icon matSuffix>badge</mat-icon>
              <mat-error
                *ngIf="profileForm.get('lastName')?.hasError('required')"
              >
                Last name is required
              </mat-error>
              <mat-error
                *ngIf="profileForm.get('lastName')?.hasError('minlength')"
              >
                Last name must be at least 2 characters
              </mat-error>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Email Address</mat-label>
              <input matInput type="email" formControlName="email" required />
              <mat-icon matSuffix>email</mat-icon>
              <mat-error *ngIf="profileForm.get('email')?.hasError('required')">
                Email is required
              </mat-error>
              <mat-error *ngIf="profileForm.get('email')?.hasError('email')">
                Please enter a valid email address
              </mat-error>
            </mat-form-field>
          </div>
        </div>

        <!-- Current Information Display -->
        <div class="form-section">
          <h3 class="section-title">
            <mat-icon>info</mat-icon>
            Current Account Information
          </h3>

          <div class="info-display">
            <div class="info-item">
              <label class="info-label">Role</label>
              <span class="info-value">{{ currentUser?.role }}</span>
              <small class="info-note">Your role cannot be changed</small>
            </div>

            <div class="info-item">
              <label class="info-label">Account Status</label>
              <span class="info-value active-status">Active</span>
              <small class="info-note">Managed by administrators</small>
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <div class="action-buttons">
            <button
              mat-button
              type="button"
              (click)="resetForm()"
              [disabled]="isLoading"
            >
              <mat-icon>refresh</mat-icon>
              Reset Changes
            </button>

            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="profileForm.invalid || isLoading || !hasChanges()"
            >
              <mat-spinner
                diameter="20"
                *ngIf="isLoading"
                class="button-spinner"
              ></mat-spinner>
              <mat-icon *ngIf="!isLoading">save</mat-icon>
              {{ isLoading ? "Saving..." : "Save Changes" }}
            </button>
          </div>

          <div class="form-hints">
            <p class="hint-text">
              <mat-icon class="hint-icon">info</mat-icon>
              Changes will be reflected across the application after saving.
            </p>
          </div>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
